window.onload=function(){var b={x:window.innerWidth,y:window.innerHeight};var k=new Phaser.Game(b.x,b.y,Phaser.AUTO,"",{preload:i,create:g,update:e,render:c});function h(){this.position={x:0,y:0};this.health=100;this.alive=true;this.maxSpeed=130;this.accelerate=5;this.speed=0}h.prototype={init:function(){this.spawn(this.position.x,this.position.y);this.setAnimation();k.physics.enable(this.object,Phaser.Physics.ARCADE)},update:function(){},spawn:function(l,m){this.position={x:l,y:m};this.object=k.add.sprite(this.position.y,this.position.x,this.spriteName,this.spriteName)},setAnimation:function(){this.object.animations.add("move_bottom",this.animations.move_bottom,10,true);this.object.animations.add("move_left",this.animations.move_left,8,true);this.object.animations.add("move_right",this.animations.move_right,8,true);this.object.animations.add("move_top",this.animations.move_top,8,true)},goBottom:function(){if(this.accelerate!=false){this.object.body.velocity.x=0;if(this.speed<this.maxSpeed){this.speed+=this.accelerate}}else{this.speed=this.maxSpeed}this.object.animations.play("move_bottom");this.object.body.velocity.y=this.speed},goTop:function(){if(this.accelerate!=false){this.object.body.velocity.x=0;if(this.speed<this.maxSpeed){this.speed+=this.accelerate}}else{this.speed=this.maxSpeed}this.object.animations.play("move_top");this.object.body.velocity.y=-this.speed},goRight:function(){if(this.accelerate!=false){this.object.body.velocity.y=0;if(this.speed<this.maxSpeed){this.speed+=this.accelerate}}else{this.speed=this.maxSpeed}this.object.body.velocity.y=0;if(this.speed<this.maxSpeed){this.speed+=this.accelerate}this.object.animations.play("move_right");this.object.body.velocity.x=this.speed},goLeft:function(){if(this.accelerate!=false){this.object.body.velocity.y=0;if(this.speed<this.maxSpeed){this.speed+=this.accelerate}}else{this.speed=this.maxSpeed}this.object.animations.play("move_left");this.object.body.velocity.x=-this.speed},goStop:function(){if(this.accelerate!=false){if(this.speed>0){this.speed-=this.accelerate}if(this.speed<0){this.speed=0}}else{this.speed=0}if(this.object.body.velocity.x>0){this.object.body.velocity.x=this.speed}if(this.object.body.velocity.y>0){this.object.body.velocity.y=this.speed}if(this.object.body.velocity.x<0){this.object.body.velocity.x=-this.speed}if(this.object.body.velocity.y<0){this.object.body.velocity.y=-this.speed}if(this.object.body.velocity.y==0&&this.object.body.velocity.x==0){this.object.animations.stop()}}};function a(l,m){h.apply(this,arguments);this.spriteName="enemy1";this.animations={move_bottom:["enemy1","enemy1_bottom"],move_top:["enemy1_top","enemy1_top2"],move_left:["enemy1_left","enemy1_left2"],move_right:["enemy1_right","enemy1_right2"]};this.position={x:l,y:m};this.targets=[];this.accelerate=false;this.areaVisibility={top:300,bottom:300,left:300,right:300};this.oversight=40;this.init();this.object.body.immovable=true}a.prototype=Object.create(h.prototype);a.prototype.constructor=a;a.prototype.update=function(){for(var l=0;l<this.targets.length;l++){if(this.visibility(this.targets[l])){console.log(this.checkNearby(this.targets[l]));if(this.checkNearby(this.targets[l])){this.goStop();break}if((this.targets[l].object.y+this.object.body.width)>(this.object.y+this.object.body.width)&&(this.targets[l].object.y+this.object.body.width)>(this.object.y+this.object.body.width-this.oversight)){this.goBottom()}else{if((this.targets[l].object.y-this.object.body.width)<(this.object.y+this.object.body.width)&&(this.targets[l].object.y-this.object.body.width)<(this.object.y+this.object.body.width+this.oversight)){this.goTop()}}if((this.targets[l].object.x-this.object.body.width)>(this.object.x+this.object.body.width)&&(this.targets[l].object.x-this.object.body.width)>(this.object.x+this.object.body.width-this.oversight)){this.goRight()}else{if((this.targets[l].object.x+this.object.body.width)<(this.object.x+this.object.body.width)&&(this.targets[l].object.x+this.object.body.width)<(this.object.x+this.object.body.width+this.oversight)){this.goLeft()}}break}else{this.goStop()}}};a.prototype.checkNearby=function(l){if(l.object.y<(this.object.y+this.oversight*1.4)&&l.object.y>(this.object.y-this.oversight*1.4)&&l.object.x<(this.object.x+this.oversight*1.4)&&l.object.x>(this.object.x-this.oversight*1.4)){return true}return false};a.prototype.visibility=function(l){if(l.object.y<(this.object.y+this.areaVisibility.top)&&l.object.y>(this.object.y-this.areaVisibility.bottom)&&l.object.x<(this.object.x+this.areaVisibility.right)&&l.object.y>(this.object.y-this.areaVisibility.left)){return true}return false};function d(m,l,n){h.apply(this,arguments);this.name=m;this.spriteName="player";this.animations={move_bottom:["player","player_bottom"],move_top:["player_top","player_top2"],move_left:["player_left","player_left2"],move_right:["player_right","player_right2"]};this.keyboard=new j(this);this.position={x:l,y:n};this.init()}d.prototype=Object.create(h.prototype);d.prototype.constructor=d;d.prototype.update=function(){this.keyboard.update()};function f(){this.player=new d("snatvb",100,100);this.ememies=this.createEnemies();k.physics.arcade.collide(this.player.object,this.ememies);k.camera.follow(this.player.object)}f.prototype={update:function(){this.player.update();k.physics.arcade.collide(this.player.object,this.ememies[0].object);this.ememies[0].update()},createEnemies:function(){var m,n=[];for(var l=0;l<1;l++){m=new a(10,10);m.targets.push(this.player);n.push(m)}return n}};function j(l){this.keys=k.input.keyboard.createCursorKeys();this.obj=l}j.prototype={update:function(){var l=this.obj;if(this.keys.down.isDown){l.goBottom();return true}else{if(this.keys.up.isDown){l.goTop();return true}else{if(this.keys.left.isDown){l.goLeft();return true}else{if(this.keys.right.isDown){l.goRight();return true}else{l.goStop()}}}}}};function i(){k.load.atlas("player","img/characters/one.png","img/characters/one.json");k.load.atlas("enemy1","img/enemies/one.png","img/enemies/one.json");k.load.image("land","img/light_grass.png")}function g(){k.world.setBounds(-1000,-1000,3000,3000);land=k.add.tileSprite(0,0,b.x,b.y,"land");land.fixedToCamera=true;k.physics.startSystem(Phaser.Physics.ARCADE);zvgame=new f()}function e(){zvgame.update();land.tilePosition.x=-k.camera.x;land.tilePosition.y=-k.camera.y}function c(){}};